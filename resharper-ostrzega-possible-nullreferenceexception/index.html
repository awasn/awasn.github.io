<!DOCTYPE HTML>
<html lang="pl-pl">
    <head>
        <meta name="theme-color" content="#405365"/>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="generator" content="Hugo 0.90.1" />
        <meta name="description" content="ReSharper pomaga uniknąć błędów w kodzie dodając ostrzeżenia" />
        <title>ReSharper ostrzega - Possible NullReferenceException - arkadiusz wasniewski blog</title>
        <link rel="canonical" href="https://awasn.github.io/resharper-ostrzega-possible-nullreferenceexception/">
        <link rel="prev" title="Metoda fabryki" href="https://awasn.github.io/metoda-fabryki/">
        <link rel="next" title="HTTP - Własny serwer komunikacji. Część #1 - Wstęp" href="https://awasn.github.io/http-wlasny-serwer-komunikacji-cz1-wstep/">

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css" integrity="sha256-Q0zCrUs2IfXWYx0uMKJfG93CvF6oVII21waYsAV4/8Q=" crossorigin="anonymous" />
        
        
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css" integrity="sha256-YqnnS/cQ7vE7gfVjdfx+JMi5EFD6m6Zqdemj81rs6PU=" crossorigin="anonymous" />
        
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/styles/agate.min.css">
        <link rel="stylesheet" href="https://awasn.github.io/awasn.min.809247dcc0227e384b256fd9df3f1c82b2b752f0ca6ba0f97410d05bcdd60729.css" integrity="sha256-gJJH3MAifjhLJW/Z3z8cgrK3UvDKa6D5dBDQW83WByk=" />

    </head>
    <body>
        <header>
            <nav class="container" >
                <div class="pure-menu pure-menu-horizontal">
                    <a class="pure-menu-heading pure-menu-link" href="https://awasn.github.io/">wasniewski</a>
                    <ul class="right pure-menu-list">
                        <li class="pure-menu-item"><a class="pure-menu-link" href="https://awasn.github.io/blog/">blog</a></li>
                        <li class="pure-menu-item"><a class="pure-menu-link" href="https://awasn.github.io/categories/">categories</a></li>
                        <li class="pure-menu-item"><a class="pure-menu-link" href="https://awasn.github.io/tags/">tags</a></li>
                        <li class="pure-menu-item"><a class="pure-menu-link" href="https://awasn.github.io/about/">about</a></li>
                    </ul>
                </div>
            </nav>
        </header>

        <main class="container">
            
    <aside class="post-published">
        <p>This post was originally published on <a href="http://zine.net.pl/blogs/arkadiusz_wasniewski/archive/2008/01/09/resharper-ostrzega-possible-nullreferenceexception.aspx" target="_blank">zine.net.pl</a> on 9 January 2008 23:15 &#43;0100</p>
    </aside>

    <article>
        <header>
            <h1>ReSharper ostrzega - Possible NullReferenceException</h1>
                <div class="post-metadata">
        <div>
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
            09 January 2008 23:15 &#43;0100
            
            &nbsp;
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
            2 min read
        </div>
        <div>
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>
            <a href="https://awasn.github.io/categories/development">Development</a>, <a href="https://awasn.github.io/categories/tools">Tools</a>
            
                &nbsp;
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>
                <a href="https://awasn.github.io/tags/.net">.NET</a>, <a href="https://awasn.github.io/tags/resharper">ReSharper</a>, <a href="https://awasn.github.io/tags/software-testing">Software testing</a>
            
        </div>
    </div>
        </header>

        <p>Kontekst rozważań jest następujący. Metoda (wersja uproszczona poniżej) buduje ściśle określoną sekwencję sterującą. Dokumentacja mówi, iż sekwencja ta musi zawierać dokładnie osiem parametrów oddzielonych średnikiem. Dopuszcza się przy tym parametry puste. Użytkownik nie jest karany (np. wyjątek) za brak parametrów. Nie spotka go też przykra niespodzianka, jeśli poda zbyt dużo parametrów.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp">    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> SampleReport(<span style="color:#66d9ef">string</span>[] names)
    {
        <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">byte</span> maxNumberOfNames = <span style="color:#ae81ff">8</span>;

        <span style="color:#66d9ef">int</span> numberOfNames = names == <span style="color:#66d9ef">null</span> ? <span style="color:#ae81ff">0</span> : names.Length;

        <span style="color:#66d9ef">byte</span>[] sequence;

        <span style="color:#66d9ef">using</span> (SequenceBuilder builder = <span style="color:#66d9ef">new</span> SequenceBuilder())
        {
            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i = <span style="color:#ae81ff">0</span>; i &lt; maxNumberOfNames; i++)
            {
                <span style="color:#66d9ef">if</span> (i &lt; numberOfNames)
                {
                    builder.AppendParameter(names[i]);
                }
                builder.AppendSemicolon();
            }

            sequence = builder.BuildUp();
        }

        printController.Print(sequence);
    }
</code></pre></div><p>Pewnym zdziwieniem w związku z tym było dla mnie zgłoszenie przez ReSharper ostrzeżenia <strong>Possible &lsquo;System.NullReferenceException&rsquo;</strong> dla linii numer 15. Wśród sugerowanych akcji zaś pojawiła się propozycja sprawdzenia czy parametr <code>names</code> nie jest <code>null</code>. W pierwszej chwili podpowiedź ta zaskoczyła mnie. Kod jest poprawny. Po dłuższym zastanowieniu stwierdziłem, iż ostrzeżenie programu ReSharper ma sens. To, że parametr <code>names</code> w tym miejscu programu nigdy nie będzie miał wartości <code>null</code> jest w teraz oczywiste. Za kilka miesięcy zaś może już tak nie być. Zamiast analizować kod można przecież wprost powiedzieć, iż w tym miejscu nie ma prawa nie być wartości. Jak to osiągnąć? Oczywiście poprzez zastosowanie asercji, które powinny być wykorzystywane do informowania siebie samego i innych programistów pracujących nad kodem, iż w danym konkretnym miejscu oczekujemy takich a nie innych wartości. Po wstawieniu właściwego sprawdzenia (linia numer 15) ReSharper usunął wcześniejsze zastrzeżenia.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp">    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> SampleReport(<span style="color:#66d9ef">string</span>[] names)
    {
        <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">byte</span> maxNumberOfNames = <span style="color:#ae81ff">8</span>;

        <span style="color:#66d9ef">int</span> numberOfNames = names == <span style="color:#66d9ef">null</span> ? <span style="color:#ae81ff">0</span> : names.Length;

        <span style="color:#66d9ef">byte</span>[] sequence;

        <span style="color:#66d9ef">using</span> (SequenceBuilder builder = <span style="color:#66d9ef">new</span> SequenceBuilder())
        {
            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i = <span style="color:#ae81ff">0</span>; i &lt; maxNumberOfNames; i++)
            {
                <span style="color:#66d9ef">if</span> (i &lt; numberOfNames)
                {
                    Debug.Assert(names != <span style="color:#66d9ef">null</span>);
                    builder.AppendParameter(names[i]);
                }
                builder.AppendSemicolon();
            }

            sequence = builder.BuildUp();
        }

        printController.Print(sequence);
    }
</code></pre></div><p>Asercja sprawdzana jest tylko w trybie <strong>Debug</strong>. W trybie <strong>Release</strong> pojawianie się takich okien jest w moim mniemaniu niedopuszczalne.</p>

    </article>
    <nav aria-label="Related posts">
        <h4>Related Posts</h4>
        <ul>
            <li><a href="https://awasn.github.io/herr-mock-i-frau-command/">Herr Mock i Frau Command</a></li>
            <li><a href="https://awasn.github.io/wyjatki/">Wyjątki</a></li>
            <li><a href="https://awasn.github.io/metoda-fabryki/">Metoda fabryki</a></li>
            <li><a href="https://awasn.github.io/dynamiczna-budowa-poprawnego-pliku-docx-w-standardzie-open-xml/">Dynamiczna budowa poprawnego pliku docx w standardzie Open XML</a></li>
            <li><a href="https://awasn.github.io/formsauthentication-w-reporing-services/">FormsAuthentication w Reporing Services</a></li>
        </ul>
    </nav>

    <nav class="pure-g post-previous-next" aria-label="Previous and next posts">
        <div class="pure-u-11-24 previous">
            <a href="https://awasn.github.io/metoda-fabryki/" aria-label="Previous post"><span aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-left"><polyline points="15 18 9 12 15 6"></polyline></svg></span></a>
            <a href="https://awasn.github.io/metoda-fabryki/">Metoda fabryki</a>
        </div>
        <div class="pure-u-2-24">&nbsp;</div>
        <div class="pure-u-11-24 next">
            <a href="https://awasn.github.io/http-wlasny-serwer-komunikacji-cz1-wstep/">HTTP - Własny serwer komunikacji. Część #1 - Wstęp</a>
            <a href="https://awasn.github.io/http-wlasny-serwer-komunikacji-cz1-wstep/" aria-label="Next post"><span aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline></svg></span></a>
        </div>
    </nav>

    


        </main>

        <footer>
            <div class="center-aligned container">
                <p>Copyright &copy; 2007-2021 Arkadiusz Waśniewski. All Rights Reserved.</p>
            </div>
        </footer>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/languages/accesslog.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/languages/dockerfile.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/languages/dos.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/languages/go.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/languages/powershell.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/languages/routeros.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/languages/typescript.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/languages/vbnet.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
    </body>
</html>