<!DOCTYPE HTML>
<html lang="pl-pl">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="generator" content="Hugo 0.54.0" />
        <meta name="description" content="Pobranie przy pomocy PowerShell i wyrażeń regularnych regex projektów z pliku rozwiązania sln środowiska Visual Studio" />
        <title>Pobranie projektów rozwiązania czyli Regex w akcji - arkadiusz wasniewski blog</title>
        <link rel="canonical" href="https://awasn.github.io/pobranie-projektow-rozwiazania-czyli-regex-w-akcji/">
        <link rel="prev" title="Zacznij od nowej strony, ale nie drukuj pustej" href="https://awasn.github.io/zacznij-od-nowej-strony-ale-nie-drukuj-pustej/">
        <link rel="next" title="(K)Cultura w PowerShell" href="https://awasn.github.io/k-cultura-w-powershell/">

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css" integrity="sha256-Q0zCrUs2IfXWYx0uMKJfG93CvF6oVII21waYsAV4/8Q=" crossorigin="anonymous" />
        
        
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css" integrity="sha256-YqnnS/cQ7vE7gfVjdfx+JMi5EFD6m6Zqdemj81rs6PU=" crossorigin="anonymous" />
        
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/styles/agate.min.css">
        <link rel="stylesheet" href="https://awasn.github.io/awasn.min.f635c2298033f6f9947349ea417d9e9d94017493351f739bf1b756d5b5bccf61.css" integrity="sha256-9jXCKYAz9vmUc0nqQX2enZQBdJM1H3Ob8bdW1bW8z2E=" />

    </head>
    <body>
        <header>
            <nav class="container" >
                <div class="pure-menu pure-menu-horizontal">
                    <a class="pure-menu-heading pure-menu-link" href="https://awasn.github.io/">wasniewski</a>
                    <ul class="right pure-menu-list">
                        <li class="pure-menu-item"><a class="pure-menu-link" href="https://awasn.github.io/blog/">blog</a></li>
                        <li class="pure-menu-item"><a class="pure-menu-link" href="https://awasn.github.io/categories/">categories</a></li>
                        <li class="pure-menu-item"><a class="pure-menu-link" href="https://awasn.github.io/tags/">tags</a></li>
                        <li class="pure-menu-item"><a class="pure-menu-link" href="https://awasn.github.io/about/">about</a></li>
                    </ul>
                </div>
            </nav>
        </header>

        <main class="container">
            
    <aside class="post-published">
        <p>This post was originally published on <a href="http://zine.net.pl/blogs/arkadiusz_wasniewski/archive/2009/10/08/pobranie-projekt-w-rozwi-zania-czyli-regex-w-akcji.aspx" target="_blank">zine.net.pl</a> on 8 October 2009 00:17 CEST</p>
    </aside>

    <article>
        <header>
            <h1>Pobranie projektów rozwiązania czyli Regex w akcji</h1>
                <div class="post-metadata">
        <div>
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
            08 October 2009 00:17 CEST
            
            &nbsp;
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
            2 min read
        </div>
        <div>
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>
            <a href="https://awasn.github.io/categories/development">Development</a>, <a href="https://awasn.github.io/categories/tools">Tools</a>
            
                &nbsp;
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>
                <a href="https://awasn.github.io/tags/powershell">PowerShell</a>, <a href="https://awasn.github.io/tags/regular-expressions">Regular Expressions</a>, <a href="https://awasn.github.io/tags/visual-studio">Visual Studio</a>
            
        </div>
    </div>
        </header>

        <p>Asumpt do poniższego rozwiązania dostarczył skrypt PowerShell, który kompiluje projekty pewnego mojego rozwiązania, i gdzie zapałałem chęcią automatycznego uaktualnienia numeru wersji we wszystkich plikach <strong>AssemblyInfo.cs</strong>. Ale gdzież są te wszystkie pliki? No w projektach…</p>

<p>Najprostszy sposób dotarcia do projektów to odczytanie pliku <strong>.sln</strong>. Hm… ale to oznacza analizowanie zawartości. Z pomocą przyszły wyrażenia regularne oraz świadomość istnienia jasno określonej struktury pliku <strong>.sln</strong>.</p>

<pre><code class="language-powershell">Project\(&quot;\{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC\}&quot;\) = &quot;(?&lt;projectName&gt;[^&quot;]+)&quot;, &quot;(?&lt;projectFolder&gt;[^&quot;]+)&quot;, &quot;(?&lt;projectGuid&gt;[^&quot;]+)&quot;\nEndProject
</code></pre>

<p>Oczywiście kilka słów wyjaśnienia. Po pierwsze wszystkie projekty rozwiązania jak i również foldery (<strong>Solution Folders</strong>) są umieszczane w sekcji zaczynającej się od słów <code>Project</code> a kończącej się na <code>EndProject</code>. Elementy będące projektami są oznaczone odpowiednim identyfikatorem Guid (konkretnie <code>{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</code>). Następnie w cudzysłowach danej sekcji mamy kolejno nazwę projektu, ścieżkę względną do projektu oraz unikalny identyfikator Guid przypisany do danego projektu. Dla ułatwienia pobierania informacji zastosowałem grupy nazwane. Czas na prosty przykład użycia:</p>

<pre><code class="language-powershell">$pattern =
    &quot;Project\(`&quot;\{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC\}`&quot;\) = &quot; +
    &quot;`&quot;(?&lt;projectName&gt;[^`&quot;]+)`&quot;, &quot; +
    &quot;`&quot;(?&lt;projectFolder&gt;[^`&quot;]+)`&quot;, &quot; +
    &quot;`&quot;(?&lt;projectGuid&gt;[^`&quot;]+)`&quot;\r\nEndProject&quot;
$regex = [regex] $pattern
$solution = [System.IO.File]::ReadAllText('d:\Solution\MySolution.sln')
$regex.Matches($solution) | ForEach-Object {
    Write-Host $_.Groups['projectName']
    Write-Host $_.Groups['projectFolder']
    Write-Host $_.Groups['projectGuid']
    Write-Host
}
</code></pre>

<p>Ze względu na składnię PowerShell wzorzec wyrażenia regularnego został nieco zmodyfikowany.</p>

<p>PS. Oczywiście można również zastosować prostsze wyrażenie regularne:</p>

<pre><code class="language-powershell">\{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC\}&quot;\) = &quot;(?&lt;projectName&gt;[^&quot;]+)&quot;, &quot;(?&lt;projectFolder&gt;[^&quot;]+)&quot;, &quot;(?&lt;projectGuid&gt;[^&quot;]+)
</code></pre>

<p>lub też bardziej odporne na potencjalne błędy (czy aby na pewno takie będą?):</p>

<pre><code class="language-powershell">\{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC\}&quot;\)\s*=\s*&quot;(?&lt;projectName&gt;[^&quot;]+)&quot;,\s*&quot;(?&lt;projectFolder&gt;[^&quot;]+)&quot;,\s*&quot;(?&lt;projectGuid&gt;[^&quot;]+)
</code></pre>

<p>Ale to już sztuka dla sztuki.</p>

    </article>
    <nav aria-label="Related posts">
        <h4>Related Posts</h4>
        <ul>
            <li><a href="https://awasn.github.io/hook-scripts-w-powershell/">Hook scripts w PowerShell</a></li>
            <li><a href="https://awasn.github.io/usuwanie-informacji-o-lokalnej-kopii-roboczej-subversion/">Usuwanie informacji o lokalnej kopii roboczej Subversion</a></li>
            <li><a href="https://awasn.github.io/konfiguracja-reporting-services-przy-pomocy-powershell/">Konfiguracja Reporting Services przy pomocy PowerShell</a></li>
            <li><a href="https://awasn.github.io/reporting-services-projekty-po-polsku/">Reporting Services - projekt(y) po polsku?</a></li>
            <li><a href="https://awasn.github.io/rozwiazanie-mobilne/">Rozwiązanie mobilne</a></li>
        </ul>
    </nav>

    <nav class="pure-g post-previous-next" aria-label="Previous and next posts">
        <div class="pure-u-11-24 previous">
            <a href="https://awasn.github.io/zacznij-od-nowej-strony-ale-nie-drukuj-pustej/" aria-label="Previous post"><span aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-left"><polyline points="15 18 9 12 15 6"></polyline></svg></span></a>
            <a href="https://awasn.github.io/zacznij-od-nowej-strony-ale-nie-drukuj-pustej/">Zacznij od nowej strony, ale nie drukuj pustej</a>
        </div>
        <div class="pure-u-2-24">&nbsp;</div>
        <div class="pure-u-11-24 next">
            <a href="https://awasn.github.io/k-cultura-w-powershell/">(K)Cultura w PowerShell</a>
            <a href="https://awasn.github.io/k-cultura-w-powershell/" aria-label="Next post"><span aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline></svg></span></a>
        </div>
    </nav>


        </main>

        <footer>
            <div class="center-aligned container">
                <p>Copyright &copy; 2007-2019 Arkadiusz Waśniewski. All Rights Reserved.</p>
            </div>
        </footer>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/languages/accesslog.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/languages/dockerfile.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/languages/dos.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/languages/go.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/languages/powershell.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/languages/routeros.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/languages/typescript.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/languages/vbnet.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
    </body>
</html>